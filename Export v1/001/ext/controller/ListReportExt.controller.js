sap.ui.define(["sap/m/MessageToast","sap/ui/export/Spreadsheet","sap/m/BusyIndicator","sap/ui/model/Filter","sap/ui/comp/smartfilterbar/SmartFilterBar","sap/m/ComboBox"],function(e,t,i){"use strict";function r(){const t=window.location.href;const i=t.indexOf("#");if(i!==-1){const e=t.substring(0,i);const r=e+"#ExportExcel-display?";return r}else{e.show("URL não identificado.");return null}}return{onBeforeRendering:function(){var e=this.getView().byId("PrintButton");if(e){e.setIcon("sap-icon://excel-attachment")}},Print:function(t){const i=r();if(!i){e.show("Ambiente não identificado!");return}const o=i;var s=sap.ui.getCore().byId("com.aggire.zui5.prio.pt.xls.9::sap.suite.ui.generic.template.ListReport.view.ListReport::Z_FI_I_GLAccountLineItem--listReportFilter");var a=s?s.getFilters():[];var n=this.getFilterHeaders(a,t);var l=this.buildSapGuiTransactionUrl(n,o);new Promise(t=>{setTimeout(()=>{if(l){window.open(l,"_blank")}else{e.show("Nenhum filtro selecionado!")}t()},1e3)}).then(()=>{})},getFilterHeaders:function(e){var t={};var i=1;var r=this.getView().byId("com.aggire.zui5.prio.pt.xls.9::sap.suite.ui.generic.template.ListReport.view.ListReport::Z_FI_I_GLAccountLineItem--listReport");var o=this.byId(r.getSmartFilterId());var s=o.getControlByKey("status");var a=s?s.getSelectedKey():null;var n=o.getControlByKey("ledger");var l=n?n.getSelectedKey():null;function u(e){if(e.aFilters&&e.aFilters.length){e.aFilters.forEach(function(e){u(e)})}else{var r=e.oValue1||"Nenhum valor aplicado";var o=e.oValue2||"";var s=e.sOperator||"EQ";var a=`LOW${i}=${encodeURIComponent(r)},`+`HIGH${i}=${encodeURIComponent(o)},`+`OP${i}=${encodeURIComponent(s)},`;var n=e.sPath||"unknown";if(!t[n]){t[n]=""}t[n]+=a;i++}}if(e&&e.length){e.forEach(function(e){u(e)})}if(a){var d=`s_status=${encodeURIComponent(a)},`;t["status"]=t["status"]?t["status"]+d:d}if(l){var c=`s_ledger=${encodeURIComponent(l)},`;t["ledger"]=t["ledger"]?t["ledger"]+c:c}var f=[];for(var p in t){if(t.hasOwnProperty(p)){f.push(`${p}="${t[p]}"`)}}return f.join("&")},buildSapGuiTransactionUrl:function(e,t){if(!e){return null}var i=t+e;return i},getCustomAppStateDataExtension:function(e){if(e){var t=this.oView.byId("Status");if(t){e.status=t.getSelectedKey()}}},restoreCustomAppStateDataExtension:function(e){if(e){if(e.status){var t=this.oView.byId("Status");t.setSelectedKey(e.status)}if(e.ledger){var i=this.oView.byId("Ledger");i.setSelectedKey(e.ledger)}}},onBeforeRebindTableExtension:function(e){var t=e.getParameter("bindingParams");var i=e.getSource();var r=this.byId(i.getSmartFilterId());if(r){var o=r.getControlByKey("status");if(o){var s=o.getSelectedKey();console.log("Valor do filtro 'status' selecionado:",s);if(s==="2"){var a=new sap.ui.model.Filter("s_status","EQ","1");var n=new sap.ui.model.Filter("s_status","EQ","3");var l=new sap.ui.model.Filter({filters:[a,n],and:false});console.log("Filtro combinado (Todos itens):",l);t.filters.push(l)}else if(s){var u=new sap.ui.model.Filter("s_status","EQ",s);console.log("Filtro criado:",u);t.filters.push(u)}}var d=r.getControlByKey("ledger");if(d){var c=d.getSelectedKey();console.log("Valor do filtro 'ledger' selecionado:",c);if(c){var f=new sap.ui.model.Filter("s_ledger","EQ",c);console.log("Filtro criado (ledger):",f);t.filters.push(f)}}}}}});
//# sourceMappingURL=ListReportExt.controller.js.map